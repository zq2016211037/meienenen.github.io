{"ast":null,"code":"import _classCallCheck from \"/Users/zqian/Documents/code/2018/react/coolblog/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/zqian/Documents/code/2018/react/coolblog/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/zqian/Documents/code/2018/react/coolblog/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/zqian/Documents/code/2018/react/coolblog/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/zqian/Documents/code/2018/react/coolblog/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/zqian/Documents/code/2018/react/coolblog/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/zqian/Documents/code/2018/react/coolblog/src/components/articleLists/articleItem/index.js\";\nimport React, { Component } from \"react\";\nimport { withRouter, Link } from 'react-router-dom';\nimport { List, message, Avatar, Spin, Button } from 'antd';\nimport axios from 'axios';\nimport InfiniteScroll from 'react-infinite-scroller';\nimport Event from '../../../assets/events.js';\n\nvar ArticleItem =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ArticleItem, _Component);\n\n  function ArticleItem(props) {\n    var _this;\n\n    _classCallCheck(this, ArticleItem);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ArticleItem).call(this, props));\n\n    _this.fetchData = function () {\n      console.log(_this.state.currentPage);\n\n      var that = _assertThisInitialized(_assertThisInitialized(_this));\n\n      var url = \"http://localhost:8003/front/getBlogLists?page=\" + (_this.state.currentPage + 1);\n      _this.blogsRes = fetch(url, {\n        method: 'GET',\n        mode: 'cors'\n      }).then(function (res) {\n        console.log(res);\n        return res.json();\n      }).then(function (json) {\n        console.log('获取的结果', json);\n\n        _this.setState({\n          articles: json.articles,\n          pages: json.pages,\n          page: json.page,\n          limit: json.limit,\n          count: json.count\n        });\n\n        Event.emit('total', that.state.limit);\n        return json;\n      }).catch(function (err) {\n        console.log('请求错误', err);\n      });\n    };\n\n    _this.handleInfiniteOnLoad = function () {\n      var data = _this.state.articles;\n\n      _this.setState({\n        loading: true\n      });\n\n      if (data.length > 14) {\n        message.warning('Infinite List loaded all');\n\n        _this.setState({\n          hasMore: false,\n          loading: false\n        });\n\n        return;\n      }\n\n      _this.fetchData(function (res) {\n        data = data.concat(res.results);\n\n        _this.setState({\n          data: data,\n          loading: false\n        });\n      });\n    };\n\n    _this.state = {\n      userLists: [],\n      pages: '',\n      page: '',\n      limit: '',\n      count: '',\n      loading: false,\n      currentPage: 1\n    };\n    return _this;\n  }\n\n  _createClass(ArticleItem, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      // console.log(this.state.currentPage);\n      Event.on('curpage', function (data) {\n        _this2.setState({\n          currentPage: data\n        });\n\n        _this2.fetchData();\n      });\n    }\n  }, {\n    key: \"showDetail\",\n    value: function showDetail(id) {\n      axios.post('http://localhost:8003/front/detailArticle', {\n        id: id\n      }).then(function (response) {\n        console.log(response);\n        Event.emit('detail', response);\n      }).catch(function (error) {\n        console.log(error);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React.createElement(\"div\", {\n        className: \"demo-infinite-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      }, React.createElement(InfiniteScroll, {\n        initialLoad: false,\n        pageStart: 0,\n        loadMore: this.handleInfiniteOnLoad,\n        hasMore: !this.state.loading && this.state.hasMore,\n        useWindow: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }, React.createElement(List, {\n        dataSource: this.state.articles,\n        renderItem: function renderItem(item) {\n          return React.createElement(List.Item, {\n            key: item._id,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 104\n            },\n            __self: this\n          }, React.createElement(List.Item.Meta, {\n            avatar: React.createElement(Avatar, {\n              src: \"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 106\n              },\n              __self: this\n            }),\n            title: React.createElement(\"a\", {\n              href: \"https://ant.design\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 107\n              },\n              __self: this\n            }, item.article_title),\n            description: React.createElement(\"p\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 108\n              },\n              __self: this\n            }, React.createElement(\"span\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 108\n              },\n              __self: this\n            }, item.author), React.createElement(\"span\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 108\n              },\n              __self: this\n            }, item.createTime)),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 105\n            },\n            __self: this\n          }), React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 110\n            },\n            __self: this\n          }, item.author), React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 111\n            },\n            __self: this\n          }, React.createElement(Link, {\n            to: \"/articleDetails\",\n            onClick: _this3.showDetail(item._id),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 112\n            },\n            __self: this\n          }, React.createElement(Button, {\n            type: \"primary\",\n            size: \"small\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 113\n            },\n            __self: this\n          }, \"\\u67E5\\u770B\\u8BE6\\u60C5\"))));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      }, this.state.loading && this.state.hasMore && React.createElement(\"div\", {\n        className: \"demo-loading-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }, React.createElement(Spin, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      })))));\n    }\n  }]);\n\n  return ArticleItem;\n}(Component);\n\nexport default ArticleItem;","map":{"version":3,"sources":["/Users/zqian/Documents/code/2018/react/coolblog/src/components/articleLists/articleItem/index.js"],"names":["React","Component","withRouter","Link","List","message","Avatar","Spin","Button","axios","InfiniteScroll","Event","ArticleItem","props","fetchData","console","log","state","currentPage","that","url","blogsRes","fetch","method","mode","then","res","json","setState","articles","pages","page","limit","count","emit","catch","err","handleInfiniteOnLoad","data","loading","length","warning","hasMore","concat","results","userLists","on","id","post","response","error","item","_id","article_title","author","createTime","showDetail"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\nimport {withRouter,Link} from 'react-router-dom'\nimport {\n    List, message, Avatar, Spin,Button\n} from 'antd';\nimport axios from 'axios';\nimport InfiniteScroll from 'react-infinite-scroller';\nimport Event from '../../../assets/events.js';\nclass ArticleItem extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n          userLists: [],\n          pages: '',\n          page: '',\n          limit: '',\n          count: '',\n          loading: false,\n          currentPage: 1\n        }\n    }\n    componentDidMount() {\n      // console.log(this.state.currentPage);\n      Event.on('curpage',data =>{\n        this.setState({\n          currentPage: data\n        });\n        this.fetchData();\n      })\n    }\n  \n    fetchData = () => {\n      console.log(this.state.currentPage);\n      var that = this;\n        var url =\"http://localhost:8003/front/getBlogLists?page=\"+(this.state.currentPage+1);\n        this.blogsRes = fetch(url,{\n            method: 'GET',\n            mode: 'cors',\n        }).then(res => {\n            console.log(res);\n            return res.json();\n        }).then(json => {\n            console.log('获取的结果', json);\n            this.setState({\n                articles: json.articles,\n                pages: json.pages,\n                page: json.page,\n                limit: json.limit,\n                count: json.count\n            });\n            Event.emit('total', that.state.limit);\n            return json;\n        }).catch(err => {\n            console.log('请求错误', err);\n        });\n    }\n  \n    handleInfiniteOnLoad = () => {\n      let data = this.state.articles;\n      this.setState({\n        loading: true,\n      });\n      if (data.length > 14) {\n        message.warning('Infinite List loaded all');\n        this.setState({\n          hasMore: false,\n          loading: false,\n        });\n        return;\n      }\n      this.fetchData((res) => {\n        data = data.concat(res.results);\n        this.setState({\n          data,\n          loading: false,\n        });\n      });\n    }\n    showDetail(id) {\n      axios.post('http://localhost:8003/front/detailArticle', {\n        id: id\n      })\n      .then(function (response) {\n        console.log(response);\n        Event.emit('detail',response);\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n    }\n    render() {\n      return (\n        <div className=\"demo-infinite-container\">\n          <InfiniteScroll\n            initialLoad={false}\n            pageStart={0}\n            loadMore={this.handleInfiniteOnLoad}\n            hasMore={!this.state.loading && this.state.hasMore}\n            useWindow={false}\n          >\n            <List\n              dataSource={this.state.articles}\n              renderItem={item => (\n                <List.Item key={item._id}>\n                  <List.Item.Meta\n                    avatar={<Avatar src=\"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png\" />}\n                    title={<a href=\"https://ant.design\">{item.article_title}</a>}\n                    description={<p><span>{item.author}</span><span>{item.createTime}</span></p>}\n                  />\n                  <div>{item.author}</div>\n                  <div>\n                    <Link to=\"/articleDetails\" onClick={this.showDetail(item._id)}>\n                        <Button type=\"primary\" size='small'>查看详情</Button>\n                    </Link>\n                  </div>\n                </List.Item>\n              )}\n            >\n              {this.state.loading && this.state.hasMore && (\n                <div className=\"demo-loading-container\">\n                  <Spin />\n                </div>\n              )}\n            </List>\n          </InfiniteScroll>\n        </div>\n      );\n    }\n  }\n\n  export default ArticleItem;"]},"metadata":{},"sourceType":"module"}